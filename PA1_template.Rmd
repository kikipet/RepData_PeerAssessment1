---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
Unzip the included zip file, which extracts a csv file. Then read the csv file
```{r echo=TRUE}
# load data
filenames <- unzip("activity.zip")
act <- read.csv(filenames)

# preprocess data
# daily total steps, na.rm=TRUE
# act$daily <- rep(tapply(act$steps, act$date, sum, na.rm=TRUE), each=288)
```

## What is mean total number of steps taken per day?
```{r echo=TRUE}
library(ggplot2)
dailyTot <- tapply(act$steps, act$date, sum, na.rm=TRUE)
qplot(dailyTot, main="Daily Total Number of Steps", xlab="Steps")
summary(dailyTot)
```
The mean total number of steps per day is 9354 steps, and the median is 10395.

## What is the average daily activity pattern?
```{r echo=TRUE}
dailyAvg <- tapply(act$steps, act$interval, mean, na.rm=TRUE)
qplot(act$interval[1:288], dailyAvg, geom="line", main="Daily Mean Number of Steps", xlab="Interval", ylab="Mean # of Steps")
```


## Imputing missing values
```{r echo=TRUE}
sum(is.na(act$steps))
sum(is.na(act$date))
sum(is.na(act$interval))
```


## Are there differences in activity patterns between weekdays and weekends?
```{r echo=TRUE}
# use the dataset with the filled-in missing values for this part
act$dayOfWeek <- sapply(lapply(act$date, as.Date), weekdays)
act$isWeekday <- factor(act$dayOfWeek %in% c("Saturday", "Sunday"), labels = c("weekday", "weekend"))

# needs to be a panel plot
qplot(act$interval[1:288], tapply(subset(act, isWeekday=="weekday")$steps, subset(act, isWeekday=="weekday")$interval, mean, na.rm=TRUE), geom="line")
qplot(act$interval[1:288], tapply(subset(act, isWeekday=="weekend")$steps, subset(act, isWeekday=="weekend")$interval, mean, na.rm=TRUE), geom="line")
```